//implement the entire datapath here